import createApi from 'api/create-api';


export default createApi('petition_admin');
export const PetitionPublicAPI = createApi('petition');


const api = (trigger) => window.__swaggerClient.apis.petition_event[trigger];
const UNKNOWN_ERROR = { error: 'UNKNOWN' };

export const PetitionEventAPI = {
  /**
   * Triggers the specified transition on the petition identified with `id`.
   * `data` is an optional parameter.
   */
  trigger(id, trigger, data) {
    return new Promise((resolve, reject) => {
      api(trigger)({ contentId: id, data }).then(response => {
        if (response && response.obj) {
          resolve(response.obj);
        } else {
          reject(UNKNOWN_ERROR);
        }
      }).catch(response => {
        if (response && response.obj) {
          reject(response.obj);
        } else {
          reject(UNKNOWN_ERROR);
        }
      });
    });
  }
};
