import * as React from 'react';
import { assert } from 'chai';
import { mount } from 'enzyme';

import TextInput from '../';


const makeTextInput = (id, name, onValueChange) => mount(
  <TextInput
    id={id}
    name={name}
    onValueChange={onValueChange}
  />
);

const simulateInputChange = (wrapper, newValue) => {
  wrapper.find('input').get(0).value = newValue;
  wrapper.find('input').first().simulate('change');
};

describe('<TextInput />', () => {
  it('renders an <input /> element', () => {
    const wrapper = makeTextInput('id', 'name', () => {});
    const inputs = wrapper.find('input');
    assert.equal(inputs.length, 1);
  });

  it('calls onValueChange when input value changes', (done) => {
    const wrapper = makeTextInput('id', 'name', () => { done(); });
    simulateInputChange(wrapper, 'hi');
  });

  it('calls onValueChange with name, new value, and isValid', (done) => {
    const handleValueChange = (name, value, isValid) => {
      assert.equal(name, 'input-name');
      assert.equal(value, 'new value');
      assert.isTrue(isValid);
      done();
    };
    const wrapper = makeTextInput('id', 'input-name', handleValueChange);
    simulateInputChange(wrapper, 'new value');
  });
});
