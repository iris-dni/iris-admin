import { assert } from 'chai';

import hasAdminAccess from '../has-admin-access';


describe('hasAdminAccess', () => {
  it('returns false for "null"', () => {
    assert.isFalse(hasAdminAccess(null));
  });

  it('returns false for user without roles', () => {
    assert.isFalse(hasAdminAccess({ email: 'me@you.com' }));
  });

  it('returns false for users without "admin" role', () => {
    assert.isFalse(hasAdminAccess({ email: 'me@you.com', roles: ['guest'] }));
  });

  it('returns true for users with "admin" role', () => {
    assert.isTrue(hasAdminAccess({ email: 'me@you.com', roles: ['editor', 'admin'] }));
  });
});
