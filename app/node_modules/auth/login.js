import * as React from 'react';
import { translate } from 'config/strings';
import settings from 'config/settings';


const getAdminBase = () => {
  const { host, pathname, protocol } = window.location;
  return `${protocol}//${host}${pathname}`;
};

const getAdminTokenUrl = () => {
  return `${getAdminBase()}${encodeURIComponent('#/')}`;
};

const getSSOLoginUrl = (loginUrl) => {
  let delimiter = loginUrl.indexOf('?') < 0 ? '?' : '&';
  return `${loginUrl}${delimiter}irisreturl=${getAdminTokenUrl()}`;
};


export default React.createClass({
  displayName: 'Login',

  render() {
    return (
      <div className="container-fluid" style={{ marginTop: 40, maxWidth: 768 }}>
        <h1>Iris Login</h1>
        <p>To access the Admin UI of Iris, you need to authenticate via SSO.</p>
        {
          settings.ssoProviders.map(p => (
            <a
              key={p.loginUrl}
              className="btn btn-default"
              href={getSSOLoginUrl(p.loginUrl)}
            >{translate('auth.sso.authenticate').replace('$1', p.name)}</a>
          ))
        }
      </div>
    );
  }
});
